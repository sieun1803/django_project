apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: django-app                     # âœ… ArgoCD UIì—ì„œ ë³´ì´ëŠ” ì•± ì´ë¦„
  namespace: argocd                    # âœ… ArgoCDê°€ ì„¤ì¹˜ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤
spec:
  project: default                     # ê¸°ë³¸ í”„ë¡œì íŠ¸ ì‚¬ìš©

  # ğŸ”¹ Git ë¦¬í¬ì§€í† ë¦¬ ì„¤ì •
  source:
    repoURL: 'https://github.com/sieun1803/django_project.git'  # âœ… ë³¸ì¸ ë ˆí¬ì§€í† ë¦¬
    targetRevision: main              # âœ… main ë¸Œëœì¹˜ ê¸°ì¤€ ë°°í¬
    path: k8s/manifests               # âœ… ì‹¤ì œ K8s yaml ì´ ìœ„ì¹˜í•œ ê²½ë¡œ (ì¤‘ìš”)

  # ğŸ”¹ ë°°í¬ ëŒ€ìƒ í´ëŸ¬ìŠ¤í„° / ë„¤ì„ìŠ¤í˜ì´ìŠ¤
  destination:
    server: 'https://kubernetes.default.svc'  # âœ… í˜„ì¬ í´ëŸ¬ìŠ¤í„° (in-cluster)
    namespace: django-ns                      # âœ… Django ë¦¬ì†ŒìŠ¤ ë„¤ì„ìŠ¤í˜ì´ìŠ¤

  # ğŸ”¹ ìë™ ë™ê¸°í™” ì •ì±… ì„¤ì •
  syncPolicy:
    automated:
      prune: true       # âœ… Gitì—ì„œ ì‚­ì œëœ ë¦¬ì†ŒìŠ¤ë¥¼ í´ëŸ¬ìŠ¤í„°ì—ì„œë„ ì‚­ì œ
      selfHeal: true    # âœ… ì‚¬ëŒì´ kubectl ë¡œ ë°”ê¾¸ë”ë¼ë„ Git ìƒíƒœë¡œ ìë™ ë³µêµ¬
    syncOptions:
      - CreateNamespace=true   # âœ… django-ns ê°€ ì—†ìœ¼ë©´ ìë™ ìƒì„±
